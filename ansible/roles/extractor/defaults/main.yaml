---
# Default values for Extractor deployment
hl7log_extractor_timezone: '{{ timezone }}'

# Custom extractor images (override from inventory for CI/CD)
hl7log_extractor_image_repository: ghcr.io/ransfordj/hl7log-extractor
hl7log_extractor_image_tag: latest
hl7_transformer_image_repository: ghcr.io/ransfordj/hl7-transformer
hl7_transformer_image_tag: 1.2.4

# Extractor configuration
hl7log_extractor_timeout: 480
hl7log_extractor_heartbeat_timeout: 30
hl7log_extractor_concurrency: 150
hl7_transformer_timeout: 60
hl7_transformer_spark_memory: 1G

# Resource configuration (dev defaults - CI friendly)
hl7log_extractor_resources:
  requests:
    cpu: 100m
    memory: 1Gi
  limits:
    cpu: 2
    memory: 2Gi
# Recommended to be low in CI because there is significantly less memory available, so
# less memory can be allocated to the heap itself.
hl7log_extractor_jvm_heap_max_ram_percentage: 60

# HL7 Transformer resources
# Memory: requests = spark_memory, limits = 2x spark_memory to account for Spark overhead
# Memory is computed in templates using jvm_memory_to_k8s filter (not computable here in defaults)
hl7_transformer_cpu_request: 100m
hl7_transformer_cpu_limit: 4

# Container paths
hl7logs_root_dir: /data

# Modality mapping file (source file on control machine)
# Default points to the reference mapping shipped with Scout
# Override in inventory.yaml to use a custom mapping file
modality_map_source_file: '{{ scout_repo_dir }}/extractor/hl7-transformer/modality_mapping_codes.csv'

# S3 paths
hl7_path: 's3://{{ lake_bucket }}/hl7'

# S3 Syncer Sidecar Configuration
s3_sync_enabled: true
s3_syncer_image_repository: ghcr.io/ransfordj/s3-syncer
s3_syncer_image_tag: latest
s3_sync_source_bucket: '{{ scratch_bucket }}'
s3_sync_source_prefix: 7500k_scale_test_data
s3_sync_interval_seconds: '60'
s3_sync_delete: 'true'
s3_sync_mode: continuous
s3_syncer_memory_request: 128Mi
s3_syncer_memory_limit: 256Mi
s3_syncer_cpu_request: 50m
s3_syncer_cpu_limit: 200m
